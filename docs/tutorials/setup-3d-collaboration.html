<!DOCTYPE html>
<html>
  <head>
    <title>ZeaCollab - Setup A collaborative 3d Scene</title>
    <meta charset="UTF-8"/>
    <style type="text/css">
      html, body {
        overflow: hidden;
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }
    </style>  
    <script src="./libs/socket.io.js"></script>
    <script>
      
// Note: this is a workaround untill Issue #20 is fixed
window.debug = function(key) {
  return (msg) => {
    console.log(msg)
  }
}
    </script>
  </head>
  <body>
    <div id="viewport"></div>
    </a>
  </body>
  <script type="module">

import {
  Color,
  Scene,
  GLRenderer,
} from 'https://unpkg.com/@zeainc/zea-engine/dist/index.esm.js'

import {
  Session, 
  SessionSync
} from 'https://unpkg.com/@zeainc/zea-collab/dist/index.rawimport.js'

const domElement = document.getElementById("viewport");

const scene = new Scene()
scene.setupGrid(10, 10)

const renderer = new GLRenderer(domElement)
renderer.setScene(scene)
renderer.resumeDrawing()

////////////////////////////////////
// Setup Collaboration

const appData = {
  scene,
  renderer
}

const socketUrl = 'https://websocket-staging.zea.live'

const color = Color.random();
const firstNames = ["Phil", "Froilan", "Alvaro", "Dan", "Mike", "Rob", "Steve"]
const lastNames = ["Taylor", "Smith", "Haines", "Moore", "Elías Pájaro Torreglosa", "Moreno"]
const userData = {
  given_name: firstNames[Math.randomInt(0, firstNames.length)],
  family_name: lastNames[Math.randomInt(0, lastNames.length)],
  id: Math.random().toString(36).slice(2, 12),
  color: color.toHex()
}

const session = new Session(userData, socketUrl);
const roomId = document.location.href
session.joinRoom(roomId);

// Create a session synch that will be responsible for creating and managing remote user avatars.
const sessionSync = new SessionSync(session, appData, userData);

  </script>
</html>

